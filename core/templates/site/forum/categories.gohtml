{{ define "getAllForumCategories" }}
    {{ if .Categories }}
        <table align="center" width="90%" border="1">
            {{ range .Categories }}
            <tr>
                <td>
                    {{ if and $.Admin .Edit }}
                        <form method="post" action="/admin/forum/categories/category/{{ .ID }}">
        {{ csrfField }}
                            Title <input name="name" value="{{ .Title.String }}">: -
                            Description: <textarea name="desc" cols="30" rows="2">{{ .Description.String }}</textarea>
                            {{ $pid := .ForumcategoryID }}
                            Parent <select name="pcid" value="{{ $pid }}"><option value="0">None</option>{{ range $.Categories }}<option value="{{ .ID }}" {{ if eq $pid .ID }}selected{{ end }}>{{ .Title.String }}</option>{{ end }}</select>
                            ({{ len .Topics }} topics)
                            <input type="submit" name="task" value="Forum category change">
                            {{ if eq (len .Topics) 0 }}
                            <input type="submit" name="task" formaction="/admin/forum/categories/category/{{ .ID }}/delete" value="Delete Category">
                            {{ end }}
                        </form>
                    {{ else }}
                        <strong><a href="/forum/category/{{ .ID }}">{{ .Title.String }}</a></strong> - {{ .Description.String }} ({{ len .Topics }})<br>
                    {{ end }}
                </td>
            </tr>
            <tr>
                <td>
                    {{ template "getAllForumCategories" (call $.CopyDataToSubCategories .) }}
                    {{ template "tableTopics" (dict "Topics" .Topics) }}
                    {{ if $.Admin }}
                        <a href="/admin/forum/categories/create?category={{ .ID }}">Create Category</a><br>
                        {{ if ne .ID 0 }}
                            <a href="/admin/forum/topics/create?category={{ .ID }}">Create Topic</a><br>
                        {{ end }}
                    {{ end }}
                </td>
            </tr>
            {{ end }}
            {{ if .Back }}
                <tr>
                    <td>
                        <a href="/forum">Back</a>
                    </td>
                </tr>
            {{ end }}
        </table>
    {{ else }}
        <p>No categories to show.</p>
    {{ end }}
{{ end }}
