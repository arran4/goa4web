// Code generated by sqlc. DO NOT EDIT.
// versions:
//   sqlc v1.25.0
// source: queries-stats.sql

package db

import (
	"context"
	"database/sql"
	"time"
)

const adminCountForumThreads = `-- name: AdminCountForumThreads :one
SELECT COUNT(*) FROM forumthread
`

func (q *Queries) AdminCountForumThreads(ctx context.Context) (int64, error) {
	row := q.db.QueryRowContext(ctx, adminCountForumThreads)
	var count int64
	err := row.Scan(&count)
	return count, err
}

const adminCountForumTopics = `-- name: AdminCountForumTopics :one
SELECT COUNT(*) FROM forumtopic
`

func (q *Queries) AdminCountForumTopics(ctx context.Context) (int64, error) {
	row := q.db.QueryRowContext(ctx, adminCountForumTopics)
	var count int64
	err := row.Scan(&count)
	return count, err
}

const adminCountThreadsByBoard = `-- name: AdminCountThreadsByBoard :one
SELECT COUNT(DISTINCT forumthread_id)
FROM imagepost
WHERE imageboard_idimageboard = ?
`

func (q *Queries) AdminCountThreadsByBoard(ctx context.Context, imageboardIdimageboard sql.NullInt32) (int64, error) {
	row := q.db.QueryRowContext(ctx, adminCountThreadsByBoard, imageboardIdimageboard)
	var count int64
	err := row.Scan(&count)
	return count, err
}

const adminDeleteTemplateOverride = `-- name: AdminDeleteTemplateOverride :exec
DELETE FROM template_overrides WHERE name = ?
`

func (q *Queries) AdminDeleteTemplateOverride(ctx context.Context, name string) error {
	_, err := q.db.ExecContext(ctx, adminDeleteTemplateOverride, name)
	return err
}

const adminForumCategoryThreadCounts = `-- name: AdminForumCategoryThreadCounts :many
SELECT c.idforumcategory, c.title,
       COUNT(DISTINCT th.idforumthread) AS threads,
       COUNT(cm.idcomments) AS comments
FROM forumcategory c
LEFT JOIN forumtopic t ON c.idforumcategory = t.forumcategory_idforumcategory
LEFT JOIN forumthread th ON th.forumtopic_idforumtopic = t.idforumtopic
LEFT JOIN comments cm ON cm.forumthread_id = th.idforumthread
GROUP BY c.idforumcategory
ORDER BY c.title
`

type AdminForumCategoryThreadCountsRow struct {
	Idforumcategory int32
	Title           sql.NullString
	Threads         int64
	Comments        int64
}

func (q *Queries) AdminForumCategoryThreadCounts(ctx context.Context) ([]*AdminForumCategoryThreadCountsRow, error) {
	rows, err := q.db.QueryContext(ctx, adminForumCategoryThreadCounts)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []*AdminForumCategoryThreadCountsRow
	for rows.Next() {
		var i AdminForumCategoryThreadCountsRow
		if err := rows.Scan(
			&i.Idforumcategory,
			&i.Title,
			&i.Threads,
			&i.Comments,
		); err != nil {
			return nil, err
		}
		items = append(items, &i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const adminForumHandlerThreadCounts = `-- name: AdminForumHandlerThreadCounts :many
SELECT t.handler,
       COUNT(DISTINCT th.idforumthread) AS threads,
       COUNT(c.idcomments) AS comments
FROM forumtopic t
LEFT JOIN forumthread th ON th.forumtopic_idforumtopic = t.idforumtopic
LEFT JOIN comments c ON c.forumthread_id = th.idforumthread
GROUP BY t.handler
ORDER BY t.handler
`

type AdminForumHandlerThreadCountsRow struct {
	Handler  string
	Threads  int64
	Comments int64
}

func (q *Queries) AdminForumHandlerThreadCounts(ctx context.Context) ([]*AdminForumHandlerThreadCountsRow, error) {
	rows, err := q.db.QueryContext(ctx, adminForumHandlerThreadCounts)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []*AdminForumHandlerThreadCountsRow
	for rows.Next() {
		var i AdminForumHandlerThreadCountsRow
		if err := rows.Scan(&i.Handler, &i.Threads, &i.Comments); err != nil {
			return nil, err
		}
		items = append(items, &i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const adminForumTopicThreadCounts = `-- name: AdminForumTopicThreadCounts :many
SELECT t.idforumtopic, t.title, t.handler,
       COUNT(DISTINCT th.idforumthread) AS threads,
       COUNT(c.idcomments) AS comments
FROM forumtopic t
LEFT JOIN forumthread th ON th.forumtopic_idforumtopic = t.idforumtopic
LEFT JOIN comments c ON c.forumthread_id = th.idforumthread
GROUP BY t.idforumtopic, t.title, t.handler
ORDER BY t.title
`

type AdminForumTopicThreadCountsRow struct {
	Idforumtopic int32
	Title        sql.NullString
	Handler      string
	Threads      int64
	Comments     int64
}

func (q *Queries) AdminForumTopicThreadCounts(ctx context.Context) ([]*AdminForumTopicThreadCountsRow, error) {
	rows, err := q.db.QueryContext(ctx, adminForumTopicThreadCounts)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []*AdminForumTopicThreadCountsRow
	for rows.Next() {
		var i AdminForumTopicThreadCountsRow
		if err := rows.Scan(
			&i.Idforumtopic,
			&i.Title,
			&i.Handler,
			&i.Threads,
			&i.Comments,
		); err != nil {
			return nil, err
		}
		items = append(items, &i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const adminGetDashboardStats = `-- name: AdminGetDashboardStats :one
SELECT
    (SELECT COUNT(*) FROM users) AS users,
    (SELECT COUNT(*) FROM language) AS languages,
    (SELECT COUNT(*) FROM site_news) AS news,
    (SELECT COUNT(*) FROM blogs) AS blogs,
    (SELECT COUNT(*) FROM forumtopic) AS forum_topics,
    (SELECT COUNT(*) FROM forumthread) AS forum_threads,
    (SELECT COUNT(*) FROM writing) AS writings
`

type AdminGetDashboardStatsRow struct {
	Users        int64
	Languages    int64
	News         int64
	Blogs        int64
	ForumTopics  int64
	ForumThreads int64
	Writings     int64
}

func (q *Queries) AdminGetDashboardStats(ctx context.Context) (*AdminGetDashboardStatsRow, error) {
	row := q.db.QueryRowContext(ctx, adminGetDashboardStats)
	var i AdminGetDashboardStatsRow
	err := row.Scan(
		&i.Users,
		&i.Languages,
		&i.News,
		&i.Blogs,
		&i.ForumTopics,
		&i.ForumThreads,
		&i.Writings,
	)
	return &i, err
}

const adminGetForumStats = `-- name: AdminGetForumStats :one
SELECT
    (SELECT COUNT(*) FROM forumcategory) AS categories,
    (SELECT COUNT(*) FROM forumtopic) AS topics,
    (SELECT COUNT(*) FROM forumthread) AS threads
`

type AdminGetForumStatsRow struct {
	Categories int64
	Topics     int64
	Threads    int64
}

func (q *Queries) AdminGetForumStats(ctx context.Context) (*AdminGetForumStatsRow, error) {
	row := q.db.QueryRowContext(ctx, adminGetForumStats)
	var i AdminGetForumStatsRow
	err := row.Scan(&i.Categories, &i.Topics, &i.Threads)
	return &i, err
}

const adminGetRecentAuditLogs = `-- name: AdminGetRecentAuditLogs :many
SELECT a.id, a.users_idusers, u.username, a.action, a.path, a.details, a.data, a.created_at
FROM audit_log a LEFT JOIN users u ON a.users_idusers = u.idusers
ORDER BY a.id DESC LIMIT ?
`

type AdminGetRecentAuditLogsRow struct {
	ID           int32
	UsersIdusers int32
	Username     sql.NullString
	Action       string
	Path         string
	Details      sql.NullString
	Data         sql.NullString
	CreatedAt    time.Time
}

func (q *Queries) AdminGetRecentAuditLogs(ctx context.Context, limit int32) ([]*AdminGetRecentAuditLogsRow, error) {
	rows, err := q.db.QueryContext(ctx, adminGetRecentAuditLogs, limit)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []*AdminGetRecentAuditLogsRow
	for rows.Next() {
		var i AdminGetRecentAuditLogsRow
		if err := rows.Scan(
			&i.ID,
			&i.UsersIdusers,
			&i.Username,
			&i.Action,
			&i.Path,
			&i.Details,
			&i.Data,
			&i.CreatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, &i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const adminGetSearchStats = `-- name: AdminGetSearchStats :one
SELECT
    (SELECT COUNT(*) FROM searchwordlist) AS words,
    (SELECT COUNT(*) FROM comments_search) AS comments,
    (SELECT COUNT(*) FROM site_news_search) AS news,
    (SELECT COUNT(*) FROM blogs_search) AS blogs,
    (SELECT COUNT(*) FROM linker_search) AS linker,
    (SELECT COUNT(*) FROM writing_search) AS writings,
    (SELECT COUNT(*) FROM imagepost_search) AS images
`

type AdminGetSearchStatsRow struct {
	Words    int64
	Comments int64
	News     int64
	Blogs    int64
	Linker   int64
	Writings int64
	Images   int64
}

func (q *Queries) AdminGetSearchStats(ctx context.Context) (*AdminGetSearchStatsRow, error) {
	row := q.db.QueryRowContext(ctx, adminGetSearchStats)
	var i AdminGetSearchStatsRow
	err := row.Scan(
		&i.Words,
		&i.Comments,
		&i.News,
		&i.Blogs,
		&i.Linker,
		&i.Writings,
		&i.Images,
	)
	return &i, err
}

const adminImageboardPostCounts = `-- name: AdminImageboardPostCounts :many
SELECT ib.idimageboard, ib.title, COUNT(ip.idimagepost) AS count
FROM imageboard ib
LEFT JOIN imagepost ip ON ip.imageboard_idimageboard = ib.idimageboard
GROUP BY ib.idimageboard
ORDER BY ib.title
`

type AdminImageboardPostCountsRow struct {
	Idimageboard int32
	Title        sql.NullString
	Count        int64
}

func (q *Queries) AdminImageboardPostCounts(ctx context.Context) ([]*AdminImageboardPostCountsRow, error) {
	rows, err := q.db.QueryContext(ctx, adminImageboardPostCounts)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []*AdminImageboardPostCountsRow
	for rows.Next() {
		var i AdminImageboardPostCountsRow
		if err := rows.Scan(&i.Idimageboard, &i.Title, &i.Count); err != nil {
			return nil, err
		}
		items = append(items, &i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const adminSetTemplateOverride = `-- name: AdminSetTemplateOverride :exec
INSERT INTO template_overrides (name, body)
VALUES (?, ?)
ON DUPLICATE KEY UPDATE body = VALUES(body)
`

type AdminSetTemplateOverrideParams struct {
	Name string
	Body string
}

func (q *Queries) AdminSetTemplateOverride(ctx context.Context, arg AdminSetTemplateOverrideParams) error {
	_, err := q.db.ExecContext(ctx, adminSetTemplateOverride, arg.Name, arg.Body)
	return err
}

const adminUserPostCounts = `-- name: AdminUserPostCounts :many
SELECT u.idusers, u.username,
       COALESCE(b.blogs, 0)     AS blogs,
       COALESCE(n.news, 0)      AS news,
       COALESCE(c.comments, 0)  AS comments,
       COALESCE(i.images, 0)    AS images,
       COALESCE(l.links, 0)     AS links,
       COALESCE(w.writings, 0)  AS writings
FROM users u
LEFT JOIN (SELECT users_idusers AS uid, COUNT(*) AS blogs FROM blogs GROUP BY users_idusers) b ON b.uid = u.idusers
LEFT JOIN (SELECT users_idusers AS uid, COUNT(*) AS news FROM site_news GROUP BY users_idusers) n ON n.uid = u.idusers
LEFT JOIN (SELECT users_idusers AS uid, COUNT(*) AS comments FROM comments GROUP BY users_idusers) c ON c.uid = u.idusers
LEFT JOIN (SELECT users_idusers AS uid, COUNT(*) AS images FROM imagepost GROUP BY users_idusers) i ON i.uid = u.idusers
LEFT JOIN (SELECT author_id AS uid, COUNT(*) AS links FROM linker GROUP BY author_id) l ON l.uid = u.idusers
LEFT JOIN (SELECT users_idusers AS uid, COUNT(*) AS writings FROM writing GROUP BY users_idusers) w ON w.uid = u.idusers
ORDER BY u.username
`

type AdminUserPostCountsRow struct {
	Idusers  int32
	Username sql.NullString
	Blogs    int64
	News     int64
	Comments int64
	Images   int64
	Links    int64
	Writings int64
}

func (q *Queries) AdminUserPostCounts(ctx context.Context) ([]*AdminUserPostCountsRow, error) {
	rows, err := q.db.QueryContext(ctx, adminUserPostCounts)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []*AdminUserPostCountsRow
	for rows.Next() {
		var i AdminUserPostCountsRow
		if err := rows.Scan(
			&i.Idusers,
			&i.Username,
			&i.Blogs,
			&i.News,
			&i.Comments,
			&i.Images,
			&i.Links,
			&i.Writings,
		); err != nil {
			return nil, err
		}
		items = append(items, &i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const adminUserPostCountsByID = `-- name: AdminUserPostCountsByID :one
SELECT
  (SELECT COUNT(*) FROM blogs b WHERE b.users_idusers = u.idusers)      AS blogs,
  (SELECT COUNT(*) FROM site_news n WHERE n.users_idusers = u.idusers)  AS news,
  (SELECT COUNT(*) FROM comments c WHERE c.users_idusers = u.idusers)   AS comments,
  (SELECT COUNT(*) FROM imagepost i WHERE i.users_idusers = u.idusers)  AS images,
  (SELECT COUNT(*) FROM linker l WHERE l.author_id = u.idusers)     AS links,
  (SELECT COUNT(*) FROM writing w WHERE w.users_idusers = u.idusers)    AS writings
FROM users u
WHERE u.idusers = ?
`

type AdminUserPostCountsByIDRow struct {
	Blogs    int64
	News     int64
	Comments int64
	Images   int64
	Links    int64
	Writings int64
}

func (q *Queries) AdminUserPostCountsByID(ctx context.Context, idusers int32) (*AdminUserPostCountsByIDRow, error) {
	row := q.db.QueryRowContext(ctx, adminUserPostCountsByID, idusers)
	var i AdminUserPostCountsByIDRow
	err := row.Scan(
		&i.Blogs,
		&i.News,
		&i.Comments,
		&i.Images,
		&i.Links,
		&i.Writings,
	)
	return &i, err
}

const adminWritingCategoryCounts = `-- name: AdminWritingCategoryCounts :many
SELECT wc.idwritingCategory, wc.title, COUNT(w.idwriting) AS count
FROM writing_category wc
LEFT JOIN writing w ON w.writing_category_id = wc.idwritingCategory
GROUP BY wc.idwritingCategory
ORDER BY wc.title
`

type AdminWritingCategoryCountsRow struct {
	Idwritingcategory int32
	Title             sql.NullString
	Count             int64
}

func (q *Queries) AdminWritingCategoryCounts(ctx context.Context) ([]*AdminWritingCategoryCountsRow, error) {
	rows, err := q.db.QueryContext(ctx, adminWritingCategoryCounts)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []*AdminWritingCategoryCountsRow
	for rows.Next() {
		var i AdminWritingCategoryCountsRow
		if err := rows.Scan(&i.Idwritingcategory, &i.Title, &i.Count); err != nil {
			return nil, err
		}
		items = append(items, &i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}

const systemGetTemplateOverride = `-- name: SystemGetTemplateOverride :one
SELECT body FROM template_overrides WHERE name = ?
`

func (q *Queries) SystemGetTemplateOverride(ctx context.Context, name string) (string, error) {
	row := q.db.QueryRowContext(ctx, systemGetTemplateOverride, name)
	var body string
	err := row.Scan(&body)
	return body, err
}

const systemListUserInfo = `-- name: SystemListUserInfo :many
SELECT u.idusers, u.username,
       IF(r.id IS NULL, 0, 1) AS admin,
       MIN(s.created_at) AS created_at
FROM users u
LEFT JOIN user_roles ur ON ur.users_idusers = u.idusers
LEFT JOIN roles r ON ur.role_id = r.id AND r.is_admin = 1
LEFT JOIN sessions s ON s.users_idusers = u.idusers
GROUP BY u.idusers
ORDER BY u.idusers
`

type SystemListUserInfoRow struct {
	Idusers   int32
	Username  sql.NullString
	Admin     interface{}
	CreatedAt interface{}
}

func (q *Queries) SystemListUserInfo(ctx context.Context) ([]*SystemListUserInfoRow, error) {
	rows, err := q.db.QueryContext(ctx, systemListUserInfo)
	if err != nil {
		return nil, err
	}
	defer rows.Close()
	var items []*SystemListUserInfoRow
	for rows.Next() {
		var i SystemListUserInfoRow
		if err := rows.Scan(
			&i.Idusers,
			&i.Username,
			&i.Admin,
			&i.CreatedAt,
		); err != nil {
			return nil, err
		}
		items = append(items, &i)
	}
	if err := rows.Close(); err != nil {
		return nil, err
	}
	if err := rows.Err(); err != nil {
		return nil, err
	}
	return items, nil
}
